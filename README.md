# DreamBridge - 高考志愿智能推荐系统

## 最近更新
- 新增学校历年招生计划数据采集功能
  - 支持按年份、批次、科类采集
  - 包含专业名称、招生人数、学费等信息
  - 支持多线程并发采集
  - 自动重试和代理切换机制
- 优化数据采集错误处理
  - 改进反爬限制检测
  - 优化错误提示信息
  - 完善数据格式验证

## 系统架构

### 整体架构

## 功能特性

### 1. 智能代理管理
- 支持快代理和公开代理源的自动切换
- 代理自动检测与切换功能
- 支持配置化的代理开关控制
- 支持本地代理配置文件

### 2. 数据采集系统
- 学校基本信息采集
- 专业分数线历史数据采集
- 招生计划数据采集
- 支持多源数据整合

### 3. 智能推荐系统
- 基于用户分数的院校匹配
- 考虑地理位置偏好
- 专业兴趣匹配
- 历史数据分析支持

### 4. 数据库设计
- 学校信息表(school)
- 专业信息表(major)
- 历史分数线表(major_score)
- 招生计划表(school_num)
- 用户信息表(user)

## 技术实现要点

### 1. 代理系统
- 多代理源支持
  - 快代理(付费)
  - ProxyScrape API(免费)
- 代理自动切换机制
- 代理可用性检测

### 2. 数据采集
- 分布式爬虫系统
- 数据清洗和标准化
- 错误重试机制
- 并发控制

### 3. 数据存储
- MySQL数据库
- 数据模型设计
- 数据完整性保证

### 4. 配置管理
- TOML配置文件
- 运行时配置切换
- 环境变量支持

## 部署要求
- Go 1.23+
- MySQL 5.7+
- 配置文件设置
  - proxy.switchon: 代理开关
  - proxy.kuaidaili: 快代理优先开关


## 问题
### 1. json.Unmarshal 无法正确解析。
major_score_his映射整个json过程中json.Unmarshal 无法正确解析。这种情况通常发生在 JSON 中的数字可能被表示为字符串，或者反之，以及可能存在的空值或特殊格式。
为了彻底解决这个问题，我们可以采用更灵活的解析策略，使用 interface{} 来接收所有字段，然后根据实际类型进行转换。这种方法可以避免类型不匹配的问题。

### 2. 反爬限制检测
- 检测访问频率限制 (code 1069)
- 自动识别 IP 封禁
- 准确的错误提示

### 3. 数据验证
- JSON 格式验证
- 字段类型检查
- 数据完整性验证

### 4. 错误恢复
- 自动重试机制
- 代理切换策略
- 错误日志记录

### 5. 最佳实践
- 错误提示应准确反映问题本质
- 区分反爬限制和数据格式错误
- 提供有效的错误诊断信息